module.exports=[47090,a=>{"use strict";var b=a.i(37936),c=a.i(61469),d=a.i(82241),e=a.i(54799);async function f(a,b){let f=await (0,d.getSession)(),g=f?.user;if(!g)return{error:"You must be logged in to place an order"};let h=e.default.randomUUID();try{c.default.prepare("INSERT INTO orders (id, user_id, total, status) VALUES (?, ?, ?, ?)").run(h,g.id,b,"Pending");let d=c.default.prepare("INSERT INTO order_items (id, order_id, product_id, quantity, price) VALUES (?, ?, ?, ?, ?)");c.default.transaction(a=>{for(let b of a)d.run(e.default.randomUUID(),h,b.id,b.quantity,b.price)})(a)}catch(a){return console.error("Failed to create order:",a),{error:"Failed to create order"}}return{success:!0,orderId:h}}async function g(){let a=await (0,d.getSession)(),b=a?.user;return b?c.default.prepare("SELECT * FROM orders WHERE user_id = ? ORDER BY created_at DESC").all(b.id):[]}async function h(a){let b=await (0,d.getSession)(),e=b?.user;if(!e)return null;let f=c.default.prepare("SELECT * FROM orders WHERE id = ? AND user_id = ?").get(a,e.id);if(!f)return null;let g=c.default.prepare(`
        SELECT oi.*, p.name, p.image 
        FROM order_items oi 
        JOIN products p ON oi.product_id = p.id 
        WHERE oi.order_id = ?
    `).all(a);return{...f,items:g}}(0,a.i(13095).ensureServerEntryExports)([f,g,h]),(0,b.registerServerReference)(f,"6024d3f96e3f9c181c5f57eaa8049fc4190206b9b4",null),(0,b.registerServerReference)(g,"007a00cf52a3b74810ba00fcbbb6927cf1566dd493",null),(0,b.registerServerReference)(h,"40066862f07ea8b3f75ebb4e4bebc03707db0de0b2",null),a.s(["createOrder",()=>f,"getOrderDetails",()=>h,"getOrders",()=>g])},80809,a=>{"use strict";var b=a.i(63707),c=a.i(47090);a.s([],77095),a.i(77095),a.s(["002e10a5ce62c25926c80418bbc53ea91a20393242",()=>b.logoutAction,"007a00cf52a3b74810ba00fcbbb6927cf1566dd493",()=>c.getOrders,"40066862f07ea8b3f75ebb4e4bebc03707db0de0b2",()=>c.getOrderDetails,"6024d3f96e3f9c181c5f57eaa8049fc4190206b9b4",()=>c.createOrder],80809)}];

//# sourceMappingURL=_c9c69a30._.js.map