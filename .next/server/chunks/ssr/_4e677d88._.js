module.exports=[47090,a=>{"use strict";var b=a.i(37936),c=a.i(61469),d=a.i(82241),e=a.i(54799);async function f(a,b){let f=await (0,d.getSession)(),g=f?.user;if(!g)return{error:"You must be logged in to place an order"};let h=e.default.randomUUID();try{c.default.prepare("INSERT INTO orders (id, user_id, total, status) VALUES (?, ?, ?, ?)").run(h,g.id,b,"Pending");let d=c.default.prepare("INSERT INTO order_items (id, order_id, product_id, quantity, price) VALUES (?, ?, ?, ?, ?)");c.default.transaction(a=>{for(let b of a)d.run(e.default.randomUUID(),h,b.id,b.quantity,b.price)})(a)}catch(a){return console.error("Failed to create order:",a),{error:"Failed to create order"}}return{success:!0,orderId:h}}async function g(){let a=await (0,d.getSession)(),b=a?.user;return b?c.default.prepare("SELECT * FROM orders WHERE user_id = ? ORDER BY created_at DESC").all(b.id):[]}async function h(a){let b=await (0,d.getSession)(),e=b?.user;if(!e)return null;let f=c.default.prepare("SELECT * FROM orders WHERE id = ? AND user_id = ?").get(a,e.id);if(!f)return null;let g=c.default.prepare(`
        SELECT oi.*, p.name, p.image 
        FROM order_items oi 
        JOIN products p ON oi.product_id = p.id 
        WHERE oi.order_id = ?
    `).all(a);return{...f,items:g}}(0,a.i(13095).ensureServerEntryExports)([f,g,h]),(0,b.registerServerReference)(f,"60a88a0dcc06005c94a03c3c9d42eeccee4fd6152e",null),(0,b.registerServerReference)(g,"00fbc32fefbc6bbe3c226b1b0b73ed4d82468ba89e",null),(0,b.registerServerReference)(h,"40124c8ded0f5738406da80858c98c16477953cb94",null),a.s(["createOrder",()=>f,"getOrderDetails",()=>h,"getOrders",()=>g])},75594,a=>{"use strict";var b=a.i(63707),c=a.i(47090);a.s([],27301),a.i(27301),a.s(["001d00b16252cf216c97e6d6f9a0cef7c51bec0114",()=>b.logoutAction,"60a88a0dcc06005c94a03c3c9d42eeccee4fd6152e",()=>c.createOrder],75594)}];

//# sourceMappingURL=_4e677d88._.js.map