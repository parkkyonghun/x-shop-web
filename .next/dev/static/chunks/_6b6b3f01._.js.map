{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/pheakdey/Documents/GitHub/x-shop-web/src/actions/auth.ts"],"sourcesContent":["\"use server\";\n\nimport db from \"@/lib/db\";\nimport { createSession, logout } from \"@/lib/session\";\nimport bcrypt from \"bcryptjs\";\n// import { v4 as uuidv4 } from \"uuid\";\nimport { redirect } from \"next/navigation\";\n\n// Since uuid isn't installed, let's use a simple random string for now or install it.\n// I'll use crypto.randomUUID() which is native in Node > 19\nimport crypto from \"crypto\";\n\nexport async function registerAction(formData: FormData) {\n    const name = formData.get(\"name\") as string;\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n\n    if (!name || !email || !password) {\n        return { error: \"All fields are required\" };\n    }\n\n    // Check if user exists\n    const existingUser = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n    if (existingUser) {\n        return { error: \"User already exists\" };\n    }\n\n    const hashedPassword = await bcrypt.hash(password, 10);\n    const id = crypto.randomUUID();\n\n    // Insert user\n    try {\n        const stmt = db.prepare(\"INSERT INTO users (id, name, email, password) VALUES (?, ?, ?, ?)\");\n        stmt.run(id, name, email, hashedPassword);\n    } catch (err) {\n        console.error(err);\n        return { error: \"Database error\" };\n    }\n\n    // Create session\n    await createSession({ id, name, email });\n    redirect(\"/\");\n}\n\nexport async function loginAction(formData: FormData) {\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n\n    const user: any = db.prepare(\"SELECT * FROM users WHERE email = ?\").get(email);\n\n    if (!user || !(await bcrypt.compare(password, user.password))) {\n        return { error: \"Invalid credentials\" };\n    }\n\n    await createSession({ id: user.id, name: user.name, email: user.email, avatar: user.avatar });\n    redirect(\"/\");\n}\n\nexport async function logoutAction() {\n    await logout();\n    redirect(\"/login\");\n}\n"],"names":[],"mappings":";;;;;;;MAYsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/pheakdey/Documents/GitHub/x-shop-web/src/app/register/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { registerAction } from \"@/actions/auth\";\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\n\nexport default function RegisterPage() {\n    const [error, setError] = useState(\"\");\n    const [loading, setLoading] = useState(false);\n    const router = useRouter();\n\n    async function handleSubmit(formData: FormData) {\n        setLoading(true);\n        setError(\"\");\n\n        const result = await registerAction(formData);\n\n        if (result?.error) {\n            setError(result.error);\n            setLoading(false);\n        }\n    }\n\n    return (\n        <div className=\"container\" style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\", minHeight: \"80vh\" }}>\n            <div className=\"glass-panel\" style={{ padding: \"3rem\", width: \"100%\", maxWidth: \"450px\" }}>\n                <h1 className=\"heading-2\" style={{ textAlign: \"center\", marginBottom: \"2rem\" }}>Create Account</h1>\n                {error && (\n                    <div style={{ background: \"rgba(220, 38, 38, 0.2)\", color: \"#f87171\", padding: \"1rem\", borderRadius: \"0.5rem\", marginBottom: \"1.5rem\", textAlign: \"center\" }}>\n                        {error}\n                    </div>\n                )}\n                <form action={handleSubmit} style={{ display: \"flex\", flexDirection: \"column\", gap: \"1.5rem\" }}>\n                    <div>\n                        <label style={{ display: \"block\", marginBottom: \"0.5rem\" }}>Name</label>\n                        <input\n                            name=\"name\"\n                            type=\"text\"\n                            required\n                            style={{ width: \"100%\", padding: \"1rem\", borderRadius: \"var(--radius-sm)\", border: \"1px solid var(--border)\", background: \"var(--background)\", color: \"var(--foreground)\" }}\n                        />\n                    </div>\n                    <div>\n                        <label style={{ display: \"block\", marginBottom: \"0.5rem\" }}>Email</label>\n                        <input\n                            name=\"email\"\n                            type=\"email\"\n                            required\n                            style={{ width: \"100%\", padding: \"1rem\", borderRadius: \"var(--radius-sm)\", border: \"1px solid var(--border)\", background: \"var(--background)\", color: \"var(--foreground)\" }}\n                        />\n                    </div>\n                    <div>\n                        <label style={{ display: \"block\", marginBottom: \"0.5rem\" }}>Password</label>\n                        <input\n                            name=\"password\"\n                            type=\"password\"\n                            required\n                            style={{ width: \"100%\", padding: \"1rem\", borderRadius: \"var(--radius-sm)\", border: \"1px solid var(--border)\", background: \"var(--background)\", color: \"var(--foreground)\" }}\n                        />\n                    </div>\n                    <button\n                        type=\"submit\"\n                        className=\"btn btn-primary\"\n                        style={{ width: \"100%\", padding: \"1rem\" }}\n                        disabled={loading}\n                    >\n                        {loading ? \"Creating Account...\" : \"Register\"}\n                    </button>\n                </form>\n                <p style={{ textAlign: \"center\", marginTop: \"1.5rem\", color: \"var(--muted)\" }}>\n                    Already have an account? <Link href=\"/login\" style={{ color: \"var(--primary)\" }}>Login</Link>\n                </p>\n            </div>\n        </div>\n    );\n}\n"],"names":["c","_c","registerAction","useState","Link","useRouter","RegisterPage","$","$i","Symbol","for","error","setError","loading","setLoading","t0","handleSubmit","formData","result","t1","display","justifyContent","alignItems","minHeight","t2","padding","width","maxWidth","t3","textAlign","marginBottom","t4","background","color","borderRadius","t5","t6","flexDirection","gap","t7","t8","border","t10","t9","t11","t12","t13","t14","t15","marginTop","t16","t17"],"mappings":"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","ignoreList":[]}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///Users/pheakdey/Documents/GitHub/x-shop-web/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}